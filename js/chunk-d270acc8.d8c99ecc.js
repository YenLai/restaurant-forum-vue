(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d270acc8"],{5652:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("AdminNav"),n("form",{staticClass:"my-4"},[n("div",{staticClass:"form-row"},[n("div",{staticClass:"col-auto"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newCategory,expression:"newCategory"}],staticClass:"form-control",attrs:{type:"text",placeholder:"新增餐廳類別..."},domProps:{value:t.newCategory},on:{input:function(e){e.target.composing||(t.newCategory=e.target.value)}}})]),n("div",{staticClass:"col-auto"},[n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.createCategory(e)}}},[t._v("新增")])])])]),n("table",{staticClass:"table"},[t._m(0),n("tbody",t._l(t.categories,(function(e){return n("tr",{key:e.id},[n("th",{attrs:{scope:"row"}},[t._v(t._s(e.id))]),n("td",{staticClass:"position-relative"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEditing,expression:"!category.isEditing"}],staticClass:"category-name"},[t._v(t._s(e.name))]),n("input",{directives:[{name:"show",rawName:"v-show",value:e.isEditing,expression:"category.isEditing"},{name:"model",rawName:"v-model",value:e.name,expression:"category.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.name},on:{keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.updateCategory(e.id)},input:function(n){n.target.composing||t.$set(e,"name",n.target.value)}}}),n("span",{directives:[{name:"show",rawName:"v-show",value:e.isEditing,expression:"category.isEditing"}],staticClass:"cancel",on:{click:function(n){return t.handleCancel(e.id)}}},[t._v("✕")])]),n("td",{staticClass:"d-flex justify-content-between"},[n("button",{directives:[{name:"show",rawName:"v-show",value:!e.isEditing,expression:"!category.isEditing"}],staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.toggleIsEditing(e.id)}}},[t._v("Edit")]),n("button",{directives:[{name:"show",rawName:"v-show",value:e.isEditing,expression:"category.isEditing"}],staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.updateCategory(e.id)}}},[t._v("Save")]),n("button",{staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.deleteCategory(e.id)}}},[t._v("Delete")])])])})),0)])],1)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",{staticClass:"thead-dark"},[n("tr",[n("th",{attrs:{scope:"col",width:"60"}},[t._v("#")]),n("th",{attrs:{scope:"col"}},[t._v("Category Name")]),n("th",{attrs:{scope:"col",width:"210"}},[t._v("Action")])])])}],i=(n("7db0"),n("d81d"),n("b0c0"),n("5530")),s=(n("96cf"),n("1da1")),o=n("e04c"),c=n("be6c"),u=n("2fa3"),d={components:{AdminNav:o["a"]},data:function(){return{categories:[],newCategory:""}},created:function(){this.fetchCategories()},methods:{fetchCategories:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c["a"].getCategories();case 3:if(n=e.sent,"OK"===n.statusText){e.next=6;break}throw new Error("無法取得餐廳種類，請稍後再試");case 6:t.categories=n.data.categories,t.categories=t.categories.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{isEditing:!1,nameCached:""})})),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),u["a"].fire({icon:"error",title:e.t0});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},createCategory:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!t.newCategory){e.next=9;break}return e.next=4,c["a"].postCategory({name:t.newCategory});case 4:if(n=e.sent,"success"===n.data.status){e.next=7;break}throw new Error("無法新增類別，請稍候再試");case 7:t.newCategory="",t.fetchCategories();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),u["a"].fire({icon:"error",title:e.t0});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},deleteCategory:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c["a"].deleteCategory(t);case 3:if(a=n.sent,"success"===a.data.status){n.next=6;break}throw new Error("無法刪除類別，請稍後再試");case 6:e.fetchCategories(),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),u["a"].fire({icon:"error",title:n.t0});case 12:case"end":return n.stop()}}),n,null,[[0,9]])})))()},updateCategory:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,a=e.categories.find((function(e){return e.id===t})).name,n.next=4,c["a"].putCategory(t,{name:a});case 4:if(r=n.sent,"success"===r.data.status){n.next=7;break}throw new Error("無法更新種類名稱，請稍後再試");case 7:e.toggleIsEditing(t),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),u["a"].fire({icon:"error",title:n.t0});case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},toggleIsEditing:function(t){this.categories=this.categories.map((function(e){return e.id!==t?e:Object(i["a"])(Object(i["a"])({},e),{},{isEditing:!e.isEditing,nameCached:e.name})}))},handleCancel:function(t){var e=this;return this.categories.map((function(n){n.id===t&&(n.name=n.nameCached,e.updateCategory(t))}))}}},l=d,g=(n("5bfe"),n("2877")),p=Object(g["a"])(l,a,r,!1,null,"1b389df5",null);e["default"]=p.exports},"5bfe":function(t,e,n){"use strict";var a=n("9369"),r=n.n(a);r.a},"7db0":function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),s=n("ae40"),o="find",c=!0,u=s(o);o in[]&&Array(1)[o]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!u},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(o)},9369:function(t,e,n){},be6c:function(t,e,n){"use strict";var a=n("2fa3");e["a"]={getUsers:function(){return a["b"].get("/admin/users")},putUser:function(t){return a["b"].put("/admin/users/".concat(t),null)},getRestaurants:function(){return a["b"].get("/admin/restaurants")},getRestaurant:function(t){return a["b"].get("/admin/restaurants/".concat(t))},postRestaurant:function(t){return a["b"].post("/admin/restaurants",t)},putRestaurant:function(t,e){return a["b"].put("/admin/restaurants/".concat(t),e)},deleteRestaurant:function(t){return a["b"].delete("/admin/restaurants/".concat(t))},getCategories:function(){return a["b"].get("/admin/categories")},postCategory:function(t){return a["b"].post("/admin/categories",t)},putCategory:function(t,e){return a["b"].put("/admin/categories/".concat(t),e)},deleteCategory:function(t){return a["b"].delete("/admin/categories/".concat(t))}}},d81d:function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").map,i=n("1dde"),s=n("ae40"),o=i("map"),c=s("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},e04c:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-3"},[n("h1",[t._v("餐廳後台")]),n("router-link",{attrs:{to:"/admin/restaurants"}},[t._v("Restaurants")]),t._v("| "),n("router-link",{attrs:{to:"/admin/categories"}},[t._v("Categories")]),t._v("| "),n("router-link",{attrs:{to:"/admin/users"}},[t._v("Users")])],1)},r=[],i=n("2877"),s={},o=Object(i["a"])(s,a,r,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-d270acc8.d8c99ecc.js.map